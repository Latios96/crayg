set(crayg_SRCS
        basics/BoundingBox.cpp
        basics/BoundingBox.h
        basics/Color.cpp
        basics/Color.h
        basics/Gradient.h
        basics/Matrix4x4f.cpp
        basics/Matrix4x4f.h
        basics/OrthonormalBasis.cpp
        basics/OrthonormalBasis.h
        basics/Ray.cpp
        basics/Ray.h
        basics/Resolution.cpp
        basics/Resolution.h
        basics/Transform.cpp
        basics/Transform.h
        basics/Vector3f.cpp
        basics/Vector3f.h
        CraygInfo.cpp
        CraygInfo.h
        image/BucketImageBuffer.cpp
        image/BucketImageBuffer.h
        image/Image.cpp
        image/Image.h
        image/ImageAlgorithms.cpp
        image/ImageAlgorithms.h
        image/ImageBucket.cpp
        image/ImageBucket.h
        image/ImageBucketSequences.cpp
        image/ImageBucketSequences.h
        image/ImageIterators.h
        image/ImageMetadata.cpp
        image/ImageMetadata.h
        image/ImageOutputDriver.cpp
        image/ImageOutputDriver.h
        image/ImageWriter.h
        image/ImageWriters.cpp
        image/ImageWriters.h
        image/LineByLineIterator.h
        image/OpenImageIoImageWriter.cpp
        image/OpenImageIoImageWriter.h
        image/OutputDriver.h
        image/TeeOutputDriver.cpp
        image/TeeOutputDriver.h
        integrators/AbstractIntegrator.cpp
        integrators/AbstractIntegrator.h
        integrators/AmbientOcclusionIntegrator.cpp
        integrators/AmbientOcclusionIntegrator.h
        integrators/DebugIntegrator.cpp
        integrators/DebugIntegrator.h
        integrators/IntegratorContext.cpp
        integrators/IntegratorContext.h
        integrators/IntegratorFactory.h
        integrators/IntegratorSettings.cpp
        integrators/IntegratorSettings.h
        integrators/IntegratorType.h
        integrators/RaytracingIntegrator.cpp
        integrators/RaytracingIntegrator.h
        integrators/SurfaceInteraction.cpp
        integrators/SurfaceInteraction.h
        intersectors/naive/NaiveBvhBuilder.cpp
        intersectors/naive/NaiveBvhBuilder.h
        intersectors/naive/NaiveBvhNode.cpp
        intersectors/naive/NaiveBvhNode.h
        intersectors/naive/NaiveBvhSceneIntersector.cpp
        intersectors/naive/NaiveBvhSceneIntersector.h
        intersectors/embree/EmbreeBvhBuilder.cpp
        intersectors/embree/EmbreeBvhBuilder.h
        intersectors/embree/EmbreeBvh.cpp
        intersectors/embree/EmbreeBvh.h
        intersectors/embree/EmbreeSceneIntersector.cpp
        intersectors/embree/EmbreeSceneIntersector.h
        intersectors/embree/EmbreeUtils.cpp
        intersectors/embree/EmbreeUtils.h
        intersectors/IntersectorType.h
        intersectors/SceneIntersector.cpp
        intersectors/SceneIntersector.h
        intersectors/IntersectorFactory.h
        Logger.cpp
        Logger.h
        renderer/BucketSizeEstimator.cpp
        renderer/BucketSizeEstimator.h
        renderer/Renderer.cpp
        renderer/Renderer.h
        renderer/SampleAccumulator.cpp
        renderer/SampleAccumulator.h
        sampling/Random.cpp
        sampling/Random.h
        sampling/Sampling.cpp
        sampling/Sampling.h
        sampling/UnitSphereSampler.cpp
        sampling/UnitSphereSampler.h
        scene/camera/Camera.cpp
        scene/camera/Camera.h
        scene/camera/CameraModel.h
        scene/camera/PineHoleCameraModel.cpp
        scene/camera/PineHoleCameraModel.h
        scene/Imageable.cpp
        scene/Imageable.h
        scene/lights/AreaLight.cpp
        scene/lights/AreaLight.h
        scene/lights/DiskLight.cpp
        scene/lights/DiskLight.h
        scene/lights/Light.cpp
        scene/lights/Light.h
        scene/lights/RectLight.cpp
        scene/lights/RectLight.h
        scene/materials/Material.cpp
        scene/materials/Material.h
        scene/materials/ShadingNode.cpp
        scene/materials/ShadingNode.h
        scene/materials/UsdPreviewSurface.cpp
        scene/materials/UsdPreviewSurface.h
        scene/primitives/GroundPlane.cpp
        scene/primitives/GroundPlane.h
        scene/primitives/Sphere.cpp
        scene/primitives/Sphere.h
        scene/primitives/trianglemesh/BarycentricCoordinates.cpp
        scene/primitives/trianglemesh/BarycentricCoordinates.h
        scene/primitives/trianglemesh/primvars/TriangleMeshAbstractPrimVar.h
        scene/primitives/trianglemesh/primvars/TriangleMeshPerFacePrimVar.h
        scene/primitives/trianglemesh/primvars/TriangleMeshPerPointPrimVar.h
        scene/primitives/trianglemesh/primvars/TriangleMeshPerVertexPrimVar.h
        scene/primitives/trianglemesh/Triangle.cpp
        scene/primitives/trianglemesh/Triangle.h
        scene/primitives/trianglemesh/TriangleMesh.cpp
        scene/primitives/trianglemesh/TriangleMesh.h
        scene/primitives/trianglemesh/TriangleMeshConversion.cpp
        scene/primitives/trianglemesh/TriangleMeshConversion.h
        scene/RenderSettings.cpp
        scene/RenderSettings.h
        scene/Scene.cpp
        scene/Scene.h
        scene/SceneObject.cpp
        scene/SceneObject.h
        scene/Transformable.cpp
        scene/Transformable.h
        sceneIO/read/SceneReader.cpp
        sceneIO/read/SceneReader.h
        sceneIO/read/usd/BaseUsdImageableReader.h
        sceneIO/read/usd/BaseUsdLightReader.h
        sceneIO/read/usd/BaseUsdReader.h
        sceneIO/read/usd/BaseUsdXformableReader.h
        sceneIO/read/usd/UsdCameraReader.cpp
        sceneIO/read/usd/UsdCameraReader.h
        sceneIO/read/usd/UsdDiskLightReader.cpp
        sceneIO/read/usd/UsdDiskLightReader.h
        sceneIO/read/usd/UsdMaterialReadCache.cpp
        sceneIO/read/usd/UsdMaterialReadCache.h
        sceneIO/read/usd/UsdMeshReader.cpp
        sceneIO/read/usd/UsdMeshReader.h
        sceneIO/read/usd/UsdRectLightReader.cpp
        sceneIO/read/usd/UsdRectLightReader.h
        sceneIO/read/usd/UsdRenderSettingsReader.cpp
        sceneIO/read/usd/UsdRenderSettingsReader.h
        sceneIO/read/usd/UsdSceneReader.cpp
        sceneIO/read/usd/UsdSceneReader.h
        sceneIO/read/usd/UsdSphereLightReader.cpp
        sceneIO/read/usd/UsdSphereLightReader.h
        sceneIO/read/usd/UsdSphereReader.cpp
        sceneIO/read/usd/UsdSphereReader.h
        sceneIO/read/usd/UsdStageReader.cpp
        sceneIO/read/usd/UsdStageReader.h
        sceneIO/SceneReaderFactory.cpp
        sceneIO/SceneReaderFactory.h
        sceneIO/SceneWriterFactory.cpp
        sceneIO/SceneWriterFactory.h
        sceneIO/usd/CraygUsdBase.h
        sceneIO/usd/UsdConversions.cpp
        sceneIO/usd/UsdConversions.h
        sceneIO/usd/UsdReadUtils.cpp
        sceneIO/usd/UsdReadUtils.h
        sceneIO/usd/UsdUtils.h
        sceneIO/write/SceneWriter.cpp
        sceneIO/write/SceneWriter.h
        sceneIO/write/usd/BaseUsdLightWriter.h
        sceneIO/write/usd/BaseUsdSceneObjectWriter.h
        sceneIO/write/usd/BaseUsdTransformableWriter.h
        sceneIO/write/usd/BaseUsdWriter.h
        sceneIO/write/usd/UsdCameraWriter.cpp
        sceneIO/write/usd/UsdCameraWriter.h
        sceneIO/write/usd/UsdDiskLightWriter.cpp
        sceneIO/write/usd/UsdDiskLightWriter.h
        sceneIO/write/usd/UsdGroundPlaneWriter.cpp
        sceneIO/write/usd/UsdGroundPlaneWriter.h
        sceneIO/write/usd/UsdMaterialWriteCache.cpp
        sceneIO/write/usd/UsdMaterialWriteCache.h
        sceneIO/write/usd/UsdPathFactory.cpp
        sceneIO/write/usd/UsdPathFactory.h
        sceneIO/write/usd/UsdPointLightWriter.cpp
        sceneIO/write/usd/UsdPointLightWriter.h
        sceneIO/write/usd/UsdRectLightWriter.cpp
        sceneIO/write/usd/UsdRectLightWriter.h
        sceneIO/write/usd/UsdRenderSettingsWriter.cpp
        sceneIO/write/usd/UsdRenderSettingsWriter.h
        sceneIO/write/usd/UsdSceneWriter.cpp
        sceneIO/write/usd/UsdSceneWriter.h
        sceneIO/write/usd/UsdSphereWriter.cpp
        sceneIO/write/usd/UsdSphereWriter.h
        sceneIO/write/usd/UsdTriangleMeshWriter.cpp
        sceneIO/write/usd/UsdTriangleMeshWriter.h
        utils/FileSystemUtils.cpp
        utils/FileSystemUtils.h
        utils/ImageMetadataCollector.cpp
        utils/ImageMetadataCollector.h
        utils/ImagePathResolver.cpp
        utils/ImagePathResolver.h
        utils/Preconditions.cpp
        utils/Preconditions.h
        utils/ProgressReporter.cpp
        utils/ProgressReporter.h
        utils/ReadableFormatter.cpp
        utils/ReadableFormatter.h
        utils/RemainingTimeCalculator.cpp
        utils/RemainingTimeCalculator.h
        utils/StopWatch.h
        utils/ToStringHelper.h
        utils/utils.h
        )


add_library(crayg STATIC
        ${crayg_SRCS})

target_include_directories(crayg PUBLIC
        ${CMAKE_CURRENT_SOURCE_DIR})

add_custom_command(TARGET crayg PRE_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy_directory ${CONAN_LIB_DIRS_USD}/usd ${CMAKE_BINARY_DIR}/bin/usd)

if (${BUILD_WITH_COVERAGE})
    set_target_properties(crayg
            PROPERTIES COMPILE_FLAGS "${CMAKE_CXX_FLAGS} --coverage"
            LINK_FLAGS "--coverage")
endif ()

target_link_libraries(crayg ${CONAN_LIBS} ${CMAKE_DL_LIBS})
