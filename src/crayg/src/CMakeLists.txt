set(crayg_SRCS
        basics/BarycentricCoordinates.cpp
        basics/BarycentricCoordinates.h
        basics/BoundingBox.cpp
        basics/BoundingBox.h
        basics/Color.cpp
        basics/Color.h
        basics/Matrix4x4f.cpp
        basics/Matrix4x4f.h
        basics/OrthonormalBasis.cpp
        basics/OrthonormalBasis.h
        basics/Ray.cpp
        basics/Ray.h
        basics/Resolution.cpp
        basics/Resolution.h
        basics/Transform.cpp
        basics/Transform.h
        basics/Vector3f.cpp
        basics/Vector3f.h
        CameraModel.h
        CraygInfo.cpp
        CraygInfo.h
        image/BmpImageWriter.cpp
        image/BmpImageWriter.h
        image/BucketImageBuffer.cpp
        image/BucketImageBuffer.h
        image/Image.cpp
        image/Image.h
        image/ImageAlgorithms.cpp
        image/ImageAlgorithms.h
        image/ImageBucket.cpp
        image/ImageBucket.h
        image/ImageBucketSequences.cpp
        image/ImageBucketSequences.h
        image/ImageIterators.h
        image/ImageOutputDriver.cpp
        image/ImageOutputDriver.h
        image/ImageWriter.h
        image/ImageWriters.cpp
        image/ImageWriters.h
        image/LineByLineIterator.h
        image/OpenImageIoImageWriter.cpp
        image/OpenImageIoImageWriter.h
        image/OutputDriver.h
        image/TeeOutputDriver.cpp
        image/TeeOutputDriver.h
        integrators/AbstractIntegrator.cpp
        integrators/AbstractIntegrator.h
        integrators/AmbientOcclusionIntegrator.cpp
        integrators/AmbientOcclusionIntegrator.h
        integrators/DebugIntegrator.cpp
        integrators/DebugIntegrator.h
        integrators/IntegratorContext.cpp
        integrators/IntegratorContext.h
        integrators/IntegratorFactory.h
        integrators/IntegratorSettings.cpp
        integrators/IntegratorSettings.h
        integrators/IntegratorType.h
        integrators/RaytracingIntegrator.cpp
        integrators/RaytracingIntegrator.h
        integrators/SurfaceInteraction.cpp
        integrators/SurfaceInteraction.h
        intersectors/BvhBuilder.cpp
        intersectors/BvhBuilder.h
        intersectors/BvhNode.cpp
        intersectors/BvhNode.h
        intersectors/BvhSceneIntersector.cpp
        intersectors/BvhSceneIntersector.h
        intersectors/SceneIntersector.cpp
        intersectors/SceneIntersector.h
        Logger.cpp
        Logger.h
        PineHoleCameraModel.cpp
        PineHoleCameraModel.h
        renderer/Renderer.cpp
        renderer/Renderer.h
        renderer/SampleAccumulator.cpp
        renderer/SampleAccumulator.h
        sampling/Random.cpp
        sampling/Random.h
        sampling/Sampling.cpp
        sampling/Sampling.h
        sampling/UnitSphereSampler.cpp
        sampling/UnitSphereSampler.h
        scene/AreaLight.cpp
        scene/AreaLight.h
        scene/Camera.cpp
        scene/Camera.h
        scene/DiskLight.cpp
        scene/DiskLight.h
        scene/GroundPlane.cpp
        scene/GroundPlane.h
        scene/Imageable.cpp
        scene/Imageable.h
        scene/Light.cpp
        scene/Light.h
        scene/Material.cpp
        scene/Material.h
        scene/RectLight.cpp
        scene/RectLight.h
        scene/RenderSettings.cpp
        scene/RenderSettings.h
        scene/Scene.cpp
        scene/Scene.h
        scene/SceneCreator.h
        scene/SceneObject.cpp
        scene/SceneObject.h
        scene/ShadingNode.cpp
        scene/ShadingNode.h
        scene/Sphere.cpp
        scene/Sphere.h
        scene/Transformable.cpp
        scene/Transformable.h
        scene/trianglemesh/primvars/TriangleMeshAbstractPrimVar.h
        scene/trianglemesh/primvars/TriangleMeshPerPointPrimVar.h
        scene/trianglemesh/primvars/TriangleMeshPerVertexPrimVar.h
        scene/trianglemesh/Triangle.cpp
        scene/trianglemesh/Triangle.h
        scene/trianglemesh/TriangleMesh.cpp
        scene/trianglemesh/TriangleMesh.h
        scene/trianglemesh/TriangleMeshConversion.cpp
        scene/trianglemesh/TriangleMeshConversion.h
        scene/UsdPreviewSurface.cpp
        scene/UsdPreviewSurface.h
        sceneIO/read/SceneReader.cpp
        sceneIO/read/SceneReader.h
        sceneIO/read/usd/BaseUsdImageableReader.h
        sceneIO/read/usd/BaseUsdLightReader.h
        sceneIO/read/usd/BaseUsdReader.h
        sceneIO/read/usd/BaseUsdXformableReader.h
        sceneIO/read/usd/UsdCameraReader.cpp
        sceneIO/read/usd/UsdCameraReader.h
        sceneIO/read/usd/UsdDiskLightReader.cpp
        sceneIO/read/usd/UsdDiskLightReader.h
        sceneIO/read/usd/UsdMaterialReadCache.cpp
        sceneIO/read/usd/UsdMaterialReadCache.h
        sceneIO/read/usd/UsdMeshReader.cpp
        sceneIO/read/usd/UsdMeshReader.h
        sceneIO/read/usd/UsdRectLightReader.cpp
        sceneIO/read/usd/UsdRectLightReader.h
        sceneIO/read/usd/UsdRenderSettingsReader.cpp
        sceneIO/read/usd/UsdRenderSettingsReader.h
        sceneIO/read/usd/UsdSceneReader.cpp
        sceneIO/read/usd/UsdSceneReader.h
        sceneIO/read/usd/UsdSphereLightReader.cpp
        sceneIO/read/usd/UsdSphereLightReader.h
        sceneIO/read/usd/UsdSphereReader.cpp
        sceneIO/read/usd/UsdSphereReader.h
        sceneIO/read/usd/UsdStageReader.cpp
        sceneIO/read/usd/UsdStageReader.h
        sceneIO/SceneReaderFactory.cpp
        sceneIO/SceneReaderFactory.h
        sceneIO/SceneWriterFactory.cpp
        sceneIO/SceneWriterFactory.h
        sceneIO/usd/CraygUsdBase.h
        sceneIO/usd/UsdConversions.cpp
        sceneIO/usd/UsdConversions.h
        sceneIO/usd/UsdReadUtils.cpp
        sceneIO/usd/UsdReadUtils.h
        sceneIO/usd/UsdUtils.h
        sceneIO/write/SceneWriter.cpp
        sceneIO/write/SceneWriter.h
        sceneIO/write/usd/BaseUsdLightWriter.h
        sceneIO/write/usd/BaseUsdSceneObjectWriter.h
        sceneIO/write/usd/BaseUsdTransformableWriter.h
        sceneIO/write/usd/BaseUsdWriter.h
        sceneIO/write/usd/UsdCameraWriter.cpp
        sceneIO/write/usd/UsdCameraWriter.h
        sceneIO/write/usd/UsdDiskLightWriter.cpp
        sceneIO/write/usd/UsdDiskLightWriter.h
        sceneIO/write/usd/UsdGroundPlaneWriter.cpp
        sceneIO/write/usd/UsdGroundPlaneWriter.h
        sceneIO/write/usd/UsdMaterialWriteCache.cpp
        sceneIO/write/usd/UsdMaterialWriteCache.h
        sceneIO/write/usd/UsdPathFactory.cpp
        sceneIO/write/usd/UsdPathFactory.h
        sceneIO/write/usd/UsdPointLightWriter.cpp
        sceneIO/write/usd/UsdPointLightWriter.h
        sceneIO/write/usd/UsdRectLightWriter.cpp
        sceneIO/write/usd/UsdRectLightWriter.h
        sceneIO/write/usd/UsdRenderSettingsWriter.cpp
        sceneIO/write/usd/UsdRenderSettingsWriter.h
        sceneIO/write/usd/UsdSceneWriter.cpp
        sceneIO/write/usd/UsdSceneWriter.h
        sceneIO/write/usd/UsdSphereWriter.cpp
        sceneIO/write/usd/UsdSphereWriter.h
        sceneIO/write/usd/UsdTriangleMeshWriter.cpp
        sceneIO/write/usd/UsdTriangleMeshWriter.h
        utils/ImagePathResolver.cpp
        utils/ImagePathResolver.h
        utils/Preconditions.cpp
        utils/Preconditions.h
        utils/ProgressReporter.cpp
        utils/ProgressReporter.h
        utils/ReadableFormatter.cpp
        utils/ReadableFormatter.h
        utils/RemainingTimeCalculator.cpp
        utils/RemainingTimeCalculator.h
        utils/StopWatch.h
        utils/ToStringHelper.h
        utils/utils.h
        )


add_library(crayg STATIC
        ${crayg_SRCS})

target_include_directories(crayg PUBLIC
        ${CMAKE_CURRENT_SOURCE_DIR})

add_custom_command(TARGET crayg PRE_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy_directory ${CONAN_LIB_DIRS_USD}/usd ${CMAKE_BINARY_DIR}/bin/usd)

if (${BUILD_WITH_COVERAGE})
    set_target_properties(crayg
            PROPERTIES COMPILE_FLAGS "${CMAKE_CXX_FLAGS} --coverage"
            LINK_FLAGS "--coverage")
endif ()

target_link_libraries(crayg ${CONAN_LIBS} ${CMAKE_DL_LIBS})
