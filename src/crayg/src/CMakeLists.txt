set(crayg_SRCS
        basics/BoundingBox.cpp
        basics/BoundingBox.h
        basics/Color.cpp
        basics/Color.h
        basics/Matrix4x4f.cpp
        basics/Matrix4x4f.h
        basics/Ray.cpp
        basics/Ray.h
        basics/Resolution.cpp
        basics/Resolution.h
        basics/Transform.cpp
        basics/Transform.h
        basics/Vector3f.cpp
        basics/Vector3f.h
        CameraModel.h
        CraygInfo.cpp
        CraygInfo.h
        image/BmpImageWriter.cpp
        image/BmpImageWriter.h
        image/BucketImageBuffer.cpp
        image/BucketImageBuffer.h
        image/Image.cpp
        image/Image.h
        image/ImageAlgorithms.cpp
        image/ImageAlgorithms.h
        image/ImageBucket.cpp
        image/ImageBucket.h
        image/ImageBucketSequences.cpp
        image/ImageBucketSequences.h
        image/ImageIterators.h
        image/ImageOutputDriver.cpp
        image/ImageOutputDriver.h
        image/ImageWriter.h
        image/ImageWriters.cpp
        image/ImageWriters.h
        image/LineByLineIterator.h
        image/OpenImageIoImageWriter.cpp
        image/OpenImageIoImageWriter.h
        image/OutputDriver.h
        image/TeeOutputDriver.cpp
        image/TeeOutputDriver.h
        intersectors/BvhBuilder.cpp
        intersectors/BvhBuilder.h
        intersectors/BvhNode.cpp
        intersectors/BvhNode.h
        intersectors/BvhSceneIntersector.cpp
        intersectors/BvhSceneIntersector.h
        intersectors/Intersector.h
        intersectors/SceneIntersector.cpp
        intersectors/SceneIntersector.h
        Logger.cpp
        Logger.h
        PineHoleCameraModel.cpp
        PineHoleCameraModel.h
        Renderer.cpp
        Renderer.h
        samplers/UnitSphereSampler.cpp
        samplers/UnitSphereSampler.h
        scene/AreaLight.cpp
        scene/AreaLight.h
        scene/Camera.cpp
        scene/Camera.h
        scene/DiffuseMaterial.cpp
        scene/DiffuseMaterial.h
        scene/DiskLight.cpp
        scene/DiskLight.h
        scene/EmissiveMaterial.cpp
        scene/EmissiveMaterial.h
        scene/GroundPlane.cpp
        scene/GroundPlane.h
        scene/Imageable.cpp
        scene/Imageable.h
        scene/Light.cpp
        scene/Light.h
        scene/Material.cpp
        scene/Material.h
        scene/PointCloud.cpp
        scene/PointCloud.h
        scene/RectLight.cpp
        scene/RectLight.h
        scene/ReflectiveMaterial.cpp
        scene/ReflectiveMaterial.h
        scene/RenderSettings.cpp
        scene/RenderSettings.h
        scene/Scene.cpp
        scene/Scene.h
        scene/SceneCreator.h
        scene/SceneObject.cpp
        scene/SceneObject.h
        scene/ShadingNode.cpp
        scene/ShadingNode.h
        scene/Sphere.cpp
        scene/Sphere.h
        scene/Transformable.cpp
        scene/Transformable.h
        scene/Triangle.cpp
        scene/Triangle.h
        scene/TriangleMesh.cpp
        scene/TriangleMesh.h
        sceneIO/read/Deserializer.h
        sceneIO/read/json/JsonDeserializer.cpp
        sceneIO/read/json/JsonDeserializer.h
        sceneIO/read/json/JsonSceneReader.cpp
        sceneIO/read/json/JsonSceneReader.h
        sceneIO/read/SceneReader.cpp
        sceneIO/read/SceneReader.h
        sceneIO/read/usd/BaseUsdImageableReader.h
        sceneIO/read/usd/BaseUsdLightReader.h
        sceneIO/read/usd/BaseUsdReader.h
        sceneIO/read/usd/BaseUsdXformableReader.h
        sceneIO/usd/CraygUsdBase.h
        sceneIO/read/usd/UsdCameraReader.cpp
        sceneIO/read/usd/UsdCameraReader.h
        sceneIO/read/usd/UsdConversions.cpp
        sceneIO/read/usd/UsdConversions.h
        sceneIO/read/usd/UsdDiskLightReader.cpp
        sceneIO/read/usd/UsdDiskLightReader.h
        sceneIO/read/usd/UsdMaterialReadCache.cpp
        sceneIO/read/usd/UsdMaterialReadCache.h
        sceneIO/read/usd/UsdMeshReader.cpp
        sceneIO/read/usd/UsdMeshReader.h
        sceneIO/read/usd/UsdRectLightReader.cpp
        sceneIO/read/usd/UsdRectLightReader.h
        sceneIO/read/usd/UsdRenderSettingsReader.cpp
        sceneIO/read/usd/UsdRenderSettingsReader.h
        sceneIO/read/usd/UsdSceneReader.cpp
        sceneIO/read/usd/UsdSceneReader.h
        sceneIO/read/usd/UsdSphereLightReader.cpp
        sceneIO/read/usd/UsdSphereLightReader.h
        sceneIO/read/usd/UsdSphereReader.cpp
        sceneIO/read/usd/UsdSphereReader.h
        sceneIO/read/usd/UsdStageReader.cpp
        sceneIO/read/usd/UsdStageReader.h
        sceneIO/usd/UsdReadUtils.cpp
        sceneIO/usd/UsdReadUtils.h
        sceneIO/usd/UsdUtils.h
        sceneIO/SceneReaderFactory.cpp
        sceneIO/SceneReaderFactory.h
        sceneIO/SceneWriters.cpp
        sceneIO/SceneWriters.h
        sceneIO/Serializable.h
        sceneIO/write/json/JsonSerializer.cpp
        sceneIO/write/json/JsonSerializer.h
        sceneIO/write/SceneWriter.cpp
        sceneIO/write/SceneWriter.h
        sceneIO/write/Serializer.h
        sceneIO/write/SerializerImplementation.h
        ShadingMethod.cpp
        ShadingMethod.h
        utils/ImagePathResolver.cpp
        utils/ImagePathResolver.h
        utils/Preconditions.cpp
        utils/Preconditions.h
        utils/ProgressReporter.cpp
        utils/ProgressReporter.h
        utils/ReadableFormatter.cpp
        utils/ReadableFormatter.h
        utils/RemainingTimeCalculator.cpp
        utils/RemainingTimeCalculator.h
        utils/StopWatch.h
        utils/ToStringHelper.h
        utils/utils.h
        )


add_library(crayg STATIC
        ${crayg_SRCS})

target_include_directories(crayg PUBLIC
        ${CMAKE_CURRENT_SOURCE_DIR})

add_custom_command(TARGET crayg PRE_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy_directory ${CONAN_LIB_DIRS_USD}/usd ${CMAKE_BINARY_DIR}/bin/usd)

if (${BUILD_WITH_COVERAGE})
    set_target_properties(crayg
            PROPERTIES COMPILE_FLAGS "${CMAKE_CXX_FLAGS} --coverage"
            LINK_FLAGS "--coverage")
endif ()

target_link_libraries(crayg ${CONAN_LIBS} ${CMAKE_DL_LIBS})
